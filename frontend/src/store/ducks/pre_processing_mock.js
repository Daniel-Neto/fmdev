import { createActions, createReducer } from 'reduxsauce';
import Immutable from 'seamless-immutable';

export const { Types, Creators } = createActions({
  preProcessingInit: [],
  preProcessingSetFilter: ['filter'],
  preProcessingRequest: [],
  preProcessingSuccess: ['data'],
  preProcessingError: ['err'],
  getPreProcessing: ['filter'],
});

/** --------------------------------
 * Variable declarations
 * --------------------------------- */

const INITIAL_STATE = Immutable({
  data: [{ "name": "curso", "description": "Curso", "type": "Categórico", "missing": 0, "unique": 1, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": null }, { "name": "data_de_final", "description": "Data de Final", "type": "Categórico", "missing": 0, "unique": 9, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": 0.17 }, { "name": "data_de_início", "description": "Data de Início", "type": "Categórico", "missing": 0, "unique": 8, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": 0.17 }, { "name": "desempenho", "description": "DESEMPENHO", "type": "Discreto", "missing": 0, "unique": 421, "count": 6526, "mean": 4.33, "std": 3.13, "min": 0, "25%": 0.81, "50%": 4.62, "75%": 7.03, "max": 10.5, "corr": null }, { "name": "desempenho_binario", "description": "DESEMPENHO_BINARIO", "type": "Discreto", "missing": 0, "unique": 2, "count": 6526, "mean": 0.43, "std": 0.5, "min": 0, "25%": 0, "50%": 0, "75%": 1, "max": 1, "corr": -0.86 }, { "name": "desempenho_classes", "description": "DESEMPENHO_CLASSES", "type": "Categórico", "missing": 0, "unique": 3, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": -0.64 }, { "name": "forum01", "description": "FORUM01", "type": "Discreto", "missing": 0, "unique": 6, "count": 6526, "mean": 2.55, "std": 2.08, "min": 0, "25%": 0, "50%": 3, "75%": 5, "max": 5, "corr": 0.64 }, { "name": "forum02", "description": "FORUM02", "type": "Discreto", "missing": 0, "unique": 6, "count": 6526, "mean": 2.49, "std": 2.15, "min": 0, "25%": 0, "50%": 3, "75%": 5, "max": 5, "corr": 0.65 }, { "name": "forum03", "description": "FORUM03", "type": "Discreto", "missing": 0, "unique": 6, "count": 6526, "mean": 2.17, "std": 2.21, "min": 0, "25%": 0, "50%": 2, "75%": 5, "max": 5, "corr": 0.73 }, { "name": "forum04", "description": "FORUM04", "type": "Discreto", "missing": 0, "unique": 7, "count": 6526, "mean": 2.07, "std": 2.24, "min": 0, "25%": 0, "50%": 0, "75%": 5, "max": 5, "corr": 0.72 }, { "name": "id_da_disciplina", "description": "ID da Disciplina", "type": "Categórico", "missing": 0, "unique": 55, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": 0.15 }, { "name": "id_do_aluno", "description": "ID do Aluno", "type": "Categórico", "missing": 0, "unique": 510, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": 0.06 }, { "name": "media_forum", "description": "MEDIA_FORUM", "type": "Discreto", "missing": 0, "unique": 30, "count": 6526, "mean": 0.93, "std": 0.75, "min": 0, "25%": 0, "50%": 1, "75%": 1.6, "max": 2, "corr": 0.8 }, { "name": "media_provas", "description": "MEDIA_PROVAS", "type": "Discreto", "missing": 0, "unique": 38, "count": 6526, "mean": 2.31, "std": 1.83, "min": 0, "25%": 0, "50%": 2.2, "75%": 3.85, "max": 5.5, "corr": 0.91 }, { "name": "media_webquest", "description": "MEDIA_WEBQUEST", "type": "Discreto", "missing": 0, "unique": 13, "count": 6526, "mean": 1.08, "std": 1.05, "min": 0, "25%": 0, "50%": 1, "75%": 2, "max": 3, "corr": 0.82 }, { "name": "nome_da_disciplina", "description": "Nome da Disciplina", "type": "Categórico", "missing": 0, "unique": 72, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": 0.01 }, { "name": "nome_do_aluno", "description": "Nome do Aluno", "type": "Categórico", "missing": 0, "unique": 702, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": 0.06 }, { "name": "período", "description": "Período", "type": "Categórico", "missing": 0, "unique": 8, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": 0.05 }, { "name": "primeira_prova", "description": "PRIMEIRA_PROVA", "type": "Discreto", "missing": 0, "unique": 20, "count": 6526, "mean": 2.59, "std": 2.03, "min": 0, "25%": 0, "50%": 2.75, "75%": 4.4, "max": 5.5, "corr": 0.73 }, { "name": "prova01", "description": "PROVA01", "type": "Discreto", "missing": 0, "unique": 20, "count": 6526, "mean": 2.43, "std": 2.08, "min": 0, "25%": 0, "50%": 2.75, "75%": 4.4, "max": 5.5, "corr": 0.71 }, { "name": "prova01_2chamada", "description": "PROVA01_2CHAMADA", "type": "Discreto", "missing": 0, "unique": 11, "count": 6526, "mean": 0.24, "std": 0.92, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 5.5, "corr": 0.03 }, { "name": "prova02", "description": "PROVA02", "type": "Discreto", "missing": 0, "unique": 11, "count": 6526, "mean": 1.96, "std": 2.13, "min": 0, "25%": 0, "50%": 1.1, "75%": 4.4, "max": 5.5, "corr": 0.81 }, { "name": "prova02_2chamada", "description": "PROVA02_2CHAMADA", "type": "Discreto", "missing": 0, "unique": 14, "count": 6526, "mean": 0.11, "std": 0.59, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 5.5, "corr": 0.05 }, { "name": "segunda_prova", "description": "SEGUNDA_PROVA", "type": "Discreto", "missing": 0, "unique": 14, "count": 6526, "mean": 2.05, "std": 2.12, "min": 0, "25%": 0, "50%": 1.65, "75%": 4.4, "max": 5.5, "corr": 0.84 }, { "name": "semestre", "description": "Semestre", "type": "Categórico", "missing": 0, "unique": 8, "count": 6526, "mean": null, "std": null, "min": null, "25%": null, "50%": null, "75%": null, "max": null, "corr": 0.17 }, { "name": "var01", "description": "VAR01", "type": "Discreto", "missing": 0, "unique": 88, "count": 6526, "mean": 14.88, "std": 20.43, "min": 0, "25%": 3, "50%": 7, "75%": 20, "max": 241, "corr": 0.51 }, { "name": "var02", "description": "VAR02", "type": "Discreto", "missing": 0, "unique": 15, "count": 6526, "mean": 0.26, "std": 1.06, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 14, "corr": 0.2 }, { "name": "var03", "description": "VAR03", "type": "Discreto", "missing": 0, "unique": 31, "count": 6526, "mean": 1.91, "std": 4.08, "min": 0, "25%": 0, "50%": 0, "75%": 2, "max": 38, "corr": 0.26 }, { "name": "var04", "description": "VAR04", "type": "Discreto", "missing": 0, "unique": 91, "count": 6526, "mean": 12.8, "std": 24.51, "min": 0, "25%": 0, "50%": 4, "75%": 15, "max": 289, "corr": 0.51 }, { "name": "var05", "description": "VAR05", "type": "Discreto", "missing": 0, "unique": 134, "count": 6526, "mean": 33.6, "std": 33.68, "min": 0, "25%": 10, "50%": 25, "75%": 50, "max": 264, "corr": 0.49 }, { "name": "var06", "description": "VAR06", "type": "Discreto", "missing": 0, "unique": 5, "count": 6526, "mean": 0.03, "std": 0.2, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 4, "corr": 0.12 }, { "name": "var07", "description": "VAR07", "type": "Discreto", "missing": 0, "unique": 8, "count": 6526, "mean": 0.04, "std": 0.3, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 7, "corr": 0.13 }, { "name": "var08", "description": "VAR08", "type": "Discreto", "missing": 0, "unique": 18, "count": 6526, "mean": 0.49, "std": 1.37, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 38, "corr": 0.26 }, { "name": "var09", "description": "VAR09", "type": "Discreto", "missing": 0, "unique": 15, "count": 6526, "mean": 1.04, "std": 1.69, "min": 0, "25%": 0, "50%": 0, "75%": 2, "max": 17, "corr": 0.37 }, { "name": "var10", "description": "VAR10", "type": "Discreto", "missing": 0, "unique": 15, "count": 6526, "mean": 0.79, "std": 1.76, "min": 0, "25%": 0, "50%": 0, "75%": 1, "max": 16, "corr": 0.27 }, { "name": "var12", "description": "VAR12", "type": "Discreto", "missing": 0, "unique": 17, "count": 6526, "mean": 0.15, "std": 1.07, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 38, "corr": 0.2 }, { "name": "var13", "description": "VAR13", "type": "Discreto", "missing": 0, "unique": 24, "count": 6526, "mean": 9.95, "std": 8.02, "min": 0, "25%": 0, "50%": 11, "75%": 17, "max": 23, "corr": 0.54 }, { "name": "var14", "description": "VAR14", "type": "Discreto", "missing": 0, "unique": 5, "count": 6526, "mean": 1.46, "std": 1.21, "min": 0, "25%": 0, "50%": 2, "75%": 3, "max": 4, "corr": 0.57 }, { "name": "var15", "description": "VAR15", "type": "Discreto", "missing": 0, "unique": 4, "count": 6526, "mean": 1.18, "std": 1.01, "min": 0, "25%": 0, "50%": 1, "75%": 2, "max": 3, "corr": 0.78 }, { "name": "var16", "description": "VAR16", "type": "Discreto", "missing": 0, "unique": 3, "count": 6526, "mean": 0.08, "std": 0.34, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 2, "corr": -0.04 }, { "name": "var17", "description": "VAR17", "type": "Discreto", "missing": 0, "unique": 757, "count": 6526, "mean": 7.07, "std": 12.37, "min": 0, "25%": 0, "50%": 1, "75%": 7, "max": 51, "corr": 0.68 }, { "name": "var18", "description": "VAR18", "type": "Discreto", "missing": 0, "unique": 142, "count": 6526, "mean": 16.74, "std": 20.95, "min": 0, "25%": 1, "50%": 12, "75%": 23, "max": 299, "corr": 0.66 }, { "name": "var19", "description": "VAR19", "type": "Discreto", "missing": 0, "unique": 25, "count": 6526, "mean": 3.1, "std": 2.7, "min": 0, "25%": 1, "50%": 3, "75%": 4, "max": 42, "corr": 0.75 }, { "name": "var20", "description": "VAR20", "type": "Discreto", "missing": 0, "unique": 6, "count": 6526, "mean": 0.04, "std": 0.26, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 5, "corr": 0.09 }, { "name": "var21", "description": "VAR21", "type": "Discreto", "missing": 0, "unique": 25, "count": 6526, "mean": 1.34, "std": 2.21, "min": 0, "25%": 0, "50%": 0, "75%": 2, "max": 46, "corr": 0.44 }, { "name": "var22", "description": "VAR22", "type": "Discreto", "missing": 0, "unique": 39, "count": 6526, "mean": 0.81, "std": 3.02, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 51, "corr": 0.36 }, { "name": "var23", "description": "VAR23", "type": "Discreto", "missing": 0, "unique": 6, "count": 6526, "mean": 0.22, "std": 0.69, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 26, "corr": 0.18 }, { "name": "var24", "description": "VAR24", "type": "Discreto", "missing": 0, "unique": 180, "count": 6526, "mean": 2.82, "std": 3.09, "min": 0, "25%": 0, "50%": 2, "75%": 4, "max": 23, "corr": 0.7 }, { "name": "var25", "description": "VAR25", "type": "Discreto", "missing": 0, "unique": 3334, "count": 6526, "mean": 70.65, "std": 65.8, "min": 0, "25%": 0, "50%": 68.08, "75%": 80.54, "max": 271.33, "corr": 0.58 }, { "name": "var28", "description": "VAR28", "type": "Discreto", "missing": 0, "unique": 183, "count": 6526, "mean": 41.02, "std": 55.77, "min": -1, "25%": 3, "50%": 22, "75%": 55, "max": 433, "corr": 0.66 }, { "name": "var29", "description": "VAR29", "type": "Discreto", "missing": 0, "unique": 757, "count": 6526, "mean": 7.07, "std": 12.37, "min": 0, "25%": 0, "50%": 1, "75%": 7, "max": 51, "corr": 0.68 }, { "name": "var30", "description": "VAR30", "type": "Discreto", "missing": 0, "unique": 757, "count": 6526, "mean": 7.07, "std": 12.37, "min": 0, "25%": 0, "50%": 1, "75%": 7, "max": 51, "corr": 0.68 }, { "name": "var31", "description": "VAR31", "type": "Discreto", "missing": 0, "unique": 257, "count": 6526, "mean": 80.62, "std": 81.31, "min": 0, "25%": 18, "50%": 66, "75%": 113, "max": 600, "corr": 0.7 }, { "name": "var31b", "description": "VAR31b", "type": "Discreto", "missing": 0, "unique": 86, "count": 6526, "mean": 13.9, "std": 14.89, "min": 0, "25%": 0, "50%": 10, "75%": 22, "max": 102, "corr": 0.78 }, { "name": "var31c", "description": "VAR31c", "type": "Discreto", "missing": 0, "unique": 135, "count": 6526, "mean": 40.93, "std": 32.59, "min": 0, "25%": 11, "50%": 39, "75%": 61, "max": 167, "corr": 0.67 }, { "name": "var32a", "description": "VAR32a", "type": "Discreto", "missing": 0, "unique": 109, "count": 6526, "mean": 20.45, "std": 26.46, "min": 0, "25%": 3, "50%": 13, "75%": 27, "max": 296, "corr": 0.64 }, { "name": "var32b", "description": "VAR32b", "type": "Discreto", "missing": 0, "unique": 125, "count": 6526, "mean": 26.97, "std": 32.64, "min": 0, "25%": 4, "50%": 18, "75%": 38, "max": 378, "corr": 0.68 }, { "name": "var32c", "description": "VAR32c", "type": "Discreto", "missing": 0, "unique": 133, "count": 6526, "mean": 31.42, "std": 33.65, "min": 0, "25%": 5, "50%": 24, "75%": 48, "max": 350, "corr": 0.66 }, { "name": "var32d", "description": "VAR32d", "type": "Discreto", "missing": 0, "unique": 32, "count": 6526, "mean": 1.78, "std": 4.57, "min": 0, "25%": 0, "50%": 0, "75%": 2, "max": 61, "corr": 0.34 }, { "name": "var33", "description": "VAR33", "type": "Discreto", "missing": 0, "unique": 4, "count": 6526, "mean": 1.18, "std": 1.01, "min": 0, "25%": 0, "50%": 1, "75%": 2, "max": 3, "corr": 0.78 }, { "name": "var34", "description": "VAR34", "type": "Discreto", "missing": 0, "unique": 25, "count": 6526, "mean": 3.1, "std": 2.7, "min": 0, "25%": 1, "50%": 3, "75%": 4, "max": 42, "corr": 0.75 }, { "name": "var35", "description": "VAR35", "type": "Discreto", "missing": 0, "unique": 7, "count": 6526, "mean": 0.04, "std": 0.27, "min": 0, "25%": 0, "50%": 0, "75%": 0, "max": 8, "corr": 0.05 }, { "name": "webquest01", "description": "WEBQUEST01", "type": "Discreto", "missing": 0, "unique": 9, "count": 6526, "mean": 2.17, "std": 2.45, "min": 0, "25%": 0, "50%": 0, "75%": 5, "max": 10, "corr": 0.59 }, { "name": "webquest02", "description": "WEBQUEST02", "type": "Discreto", "missing": 0, "unique": 7, "count": 6526, "mean": 2.16, "std": 2.53, "min": 0, "25%": 0, "50%": 0, "75%": 5, "max": 6, "corr": 0.78 }],
  filter: { "lms": "moodle", "target": "desempenho", "courses": ["Biologia"], "subjects": [], "semesters": [], "indicators": ["curso", "data_de_final", "data_de_início", "desempenho", "desempenho_binario", "desempenho_classes", "forum01", "forum02", "forum03", "forum04", "id_da_disciplina", "id_do_aluno", "media_forum", "media_provas", "media_webquest", "nome_da_disciplina", "nome_do_aluno", "período", "primeira_prova", "prova01", "prova01_2chamada", "prova02", "prova02_2chamada", "segunda_prova", "semestre", "var01", "var02", "var03", "var04", "var05", "var06", "var07", "var08", "var09", "var10", "var12", "var13", "var14", "var15", "var16", "var17", "var18", "var19", "var20", "var21", "var22", "var23", "var24", "var25", "var28", "var29", "var30", "var31", "var31b", "var31c", "var32a", "var32b", "var32c", "var32d", "var33", "var34", "var35", "webquest01", "webquest02"], "pre_processing_constant": null, "pre_processing_strategy": "mean", "pre_processing_indicator": "forum04" },
  is_processed: true,
  loading: false,
  error: false
});

/* Reducers */

export const init = state => state.merge({
  data: [],
  path: null,
  is_processed: false,
  filter: {}
});

export const request = state => state.merge({ loading: true });

export const success = (state, { data }) => {
  console.log(JSON.stringify(data));
  return state.merge({ data: data.data, path: data.path, error: false, loading: false });
}

export const error = state => state.merge({ loading: false, error: true });

export const setFilter = (state, { filter }) => {
  console.log(JSON.stringify(filter));
  return state.merge({ filter })
};

/* Reducers to types */

export default createReducer(INITIAL_STATE, {
  [Types.PRE_PROCESSING_INIT]: init,
  [Types.PRE_PROCESSING_REQUEST]: request,
  [Types.PRE_PROCESSING_SUCCESS]: success,
  [Types.PRE_PROCESSING_ERROR]: error,
  [Types.PRE_PROCESSING_SET_FILTER]: setFilter,
});